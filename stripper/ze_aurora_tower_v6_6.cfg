;filter unpacked particle
filter:
{
	"classname" "info_particle_system"
	"targetname" "PrimeMecha_Model_parti"
}

filter:
{
	"classname" "logic_timer"
	"targetname" "PrimeMecha_Model_minitimer"
}

modify:
{
	match:
	{
		"classname" "game_ui"
		"targetname" "PrimeMecha_UI_mini"
	}
	delete:
	{
		"PressedAttack2" "PrimeMecha_Model_minitimerEnable1.7-1"
		"PressedAttack2" "PrimeMecha_Model_minitimerDisable11.7-1"
	}
}

;fix frozen zombies getting boosted after being unfrozen
modify:
{
	match:
	{
		"classname" "trigger_multiple"
		"targetname" "HumanItem_HealBlade_Skill2_Relics_FreezeTrigger"
	}
	insert:
	{
		"OnStartTouch" "!activatorRunScriptCodeself.SetVelocity(Vector(0,0,0))5.8-1"
	}
}

;patch tp avoidance spot
modify:
{
	match:
	{
		"classname" "trigger_teleport"
		"targetname" "FallOutMap_Zombie_TeleArea"
	}
	delete:
	{
		"model" "*27"
	}
}

modify:
{
	match:
	{
		"classname" "trigger_hurt"
		"targetname" "FallOutMap_CT_KillArea"
	}
	delete:
	{
		"model" "*28"
	}
}

modify:
{
	match:
	{
		"classname" "trigger_teleport"
		"targetname" "Lv3FinalRun_NoFreeFall_Teleport"
		"origin" "-7020.14 -170.5 16"
	}
	replace:
	{
		"targetname" "Lv3FinalRun_NoFreeFall_Teleport_resize"
	}
	delete:
	{
		"model" "*497"
	}
}

modify:
{
	match:
	{
		"classname" "logic_auto"
	}
	insert:
	{
		"OnMapSpawn" "FallOutMap_Zombie_TeleAreaAddOutputsolid 20.51"
		"OnMapSpawn" "FallOutMap_Zombie_TeleAreaAddOutput mins -9288 -1658.5 -62.511"
		"OnMapSpawn" "FallOutMap_Zombie_TeleAreaAddOutput maxs 9288 1658.5 62.511"
		"OnMapSpawn" "FallOutMap_CT_KillAreaAddOutputsolid 20.51"
		"OnMapSpawn" "FallOutMap_CT_KillAreaAddOutput mins -9288 -1658.5 -57.511"
		"OnMapSpawn" "FallOutMap_CT_KillAreaAddOutput maxs 9288 1658.5 57.511"
		"OnMapSpawn" "Lv3FinalRun_NoFreeFall_Teleport_resizeAddOutputsolid 20.51"
		"OnMapSpawn" "Lv3FinalRun_NoFreeFall_Teleport_resizeAddOutput mins -9288 -1658.5 -53.511"
		"OnMapSpawn" "Lv3FinalRun_NoFreeFall_Teleport_resizeAddOutput maxs 9288 1658.5 53.511"
	}
}

modify:
{
	match:
	{
		"classname" "trigger_once"
		"targetname" "BGM_ex1_otherTrigger"
	}
	insert:
	{
		"OnStartTouch" "Lv3FinalRun_NoFreeFall_Teleport_resize,Kill,,0.02,1"
	}
}

modify:
{
	match:
	{
		"classname" "func_physbox"
		"targetname" "KingBoss_Mecha_HitBox"
	}
	insert:
	{
		"OnBreak" "Lv3FinalRun_NoFreeFall_Teleport_resize,Enable,,40,1"
	}
}

;Fix boss hp scaling to match v6_8
modify:
{
	match:
	{
		"targetname" "lv4_b2_hptri"
		"classname" "trigger_multiple"
	}
	delete:
	{
		"OnStartTouch" "lv4_b3_morascounAdd850-1"
		"OnStartTouch" "lv4_b3_arescounAdd300-1"
	}
	insert:
	{
		"OnStartTouch" "lv4_b3_morascounAdd1050-1"
		"OnStartTouch" "lv4_b3_arescounAdd450-1"
	}
}

;Add freeze time to prevent trigger bugs
modify:
{
	match:
	{
		"classname" "logic_auto"
	}
	insert:
	{
		"OnMapSpawn" "Gate#1_Hint_PressedCommandmp_freezetime 30-1"
	}
}

;Fix flicker
modify:
{
	match:
	{
		"classname" "env_sprite"
	}
	replace:
	{
		"rendermode" "5"
	}
}

;Fix zombies falling out of map on stage 3
modify:
{
	match:
	{
		"targetname" "KingBoss_Mecha_HitBox"
		"classname" "func_physbox"
	}
	delete:
	{
		"OnBreak" "FallOutMap_Zombie_TeleAreaKill01"
	}
	insert:
	{
		"OnBreak" "FallOutMap_Zombie_TeleAreaSetRemoteDestinationBoss2Dead_Teleport_T_Spot01"
	}
}

;Fix a broken tp on ending of stage 4
modify:
{
	match:
	{
		"targetname" "lv4_b3SK_relaykill"
		"classname" "logic_relay"
	}
	insert:
	{
		"OnTrigger" "FallOutMap_Zombie_TeleAreaSetRemoteDestinationLv3FinalRun_Last20s_T_Tele_Spot221"
	}
}

;fix extreme stage phase 2 boss fight edict crash (from mapper)
modify:
{
	match:
	{
		"targetname" "lv4_b3_Devourer_beamtri"
		"classname" "trigger_multiple"
	}
	delete:
	{
		"OnStartTouch" "lv4_b3_Devourer_beammakerForceSpawnAtEntityOrigin!activator01"
		"OnStartTouch" "lv4_b3_Devourer_beamATurnOn0.01-1"
		"OnStartTouch" "lv4_b3_Devourer_beamBTurnOn3-1"
		"OnStartTouch" "lv4_b3_Devourer_beamhurtEnable3-1"
		"OnStartTouch" "lv4_b3_Devourer_beamteslaTurnOn3-1"
		"OnStartTouch" "lv4_b3_Devourer_beamteslaKill6-1"
		"OnStartTouch" "lv4_b3_Devourer_beamhurtKill6-1"
		"OnStartTouch" "lv4_b3_Devourer_beam_cube2Kill6-1"
		"OnStartTouch" "lv4_b3_Devourer_beamBTurnOff6-1"
		"OnStartTouch" "lv4_b3_Devourer_beamaTurnOff6-1"
		"OnStartTouch" "lv4_b3_Devourer_smmakerForceSpawn3-1"
		"OnStartTouch" "lv4_b3_Devourer_ringsoundPlaySound3-1"
		"OnStartTouch" "lv4_b3_Devourer_roar1soundPlaySound3-1"
		"OnStartTouch" "lv4_b3_Devourer_smmakerKill4-1"
		"OnStartTouch" "lv4_b2_shakeStartShake3-1"
		"OnStartTouch" "lv4_bossfade_redFadeReverse3-1"
		"OnStartTouch" "!selfAddOutputOnStartTouch lv4_b3_Devourer_beammaker:ForceSpawnAtEntityOrigin:!activator:0:13.5-1"
	}
	insert:
	{
		"OnTrigger" "lv4_b3_Devourer_beammakerForceSpawnAtEntityOrigin!activator0-1"
		"OnTrigger" "lv4_b3_Devourer_beamATurnOn0.01-1"
		"OnTrigger" "lv4_b3_Devourer_beamBTurnOn3-1"
		"OnTrigger" "lv4_b3_Devourer_beamhurtEnable3-1"
		"OnTrigger" "lv4_b3_Devourer_beamteslaTurnOn3-1"
		"OnTrigger" "lv4_b3_Devourer_beamteslaKill6-1"
		"OnTrigger" "lv4_b3_Devourer_beamhurtKill6-1"
		"OnTrigger" "lv4_b3_Devourer_beam_cube2Kill6-1"
		"OnTrigger" "lv4_b3_Devourer_beamBTurnOff6-1"
		"OnTrigger" "lv4_b3_Devourer_beamaTurnOff6-1"
		"OnTrigger" "lv4_b3_Devourer_smmakerForceSpawn3-1"
		"OnTrigger" "lv4_b3_Devourer_ringsoundPlaySound3-1"
		"OnTrigger" "lv4_b3_Devourer_roar1soundPlaySound3-1"
		"OnTrigger" "lv4_b3_Devourer_smmakerKill4-1"
		"OnTrigger" "lv4_b2_shakeStartShake3-1"
		"OnTrigger" "lv4_bossfade_redFadeReverse3-1"
	}
}