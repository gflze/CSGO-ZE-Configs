;fix repeat killer triggering
modify:
{
	match:
	{
		"classname" "trigger_hurt"
		"origin" "-6605 -14623.5 -598.5"
	}
	replace:
	{
		"classname" "trigger_multiple"
	}
	delete:
	{
		"nodmgforce" "0"
		"damagetype" "0"
		"damagemodel" "0"
		"damagecap" "90000"
		"damage" "90000"
	}
	insert:
	{
		"wait" "0"
		"OnTrigger" "!activatorSetHealth00-1"
	}
}

;fix tp avoidance spot
add:
{
	"classname" "trigger_teleport"
	"origin" "-4181.5 13133.5 -3875"
	"model" "*333"
	"targetname" "stage3_mars_tp"
	"UseLandmarkAngles" "1"
	"target" "hellteleport"
	"StartDisabled" "1"
	"spawnflags" "1"
}

;stop zms from walking into tp free area after 1st lvl 3 boss dies?
modify:
{
	match:
	{
		"classname" "logic_relay"
		"targetname" "guardian_death"
	}
	delete:
	{
		"OnTrigger" "Noctali_Boss_Push_Hp1Kill0-1"
	}
	insert:
	{
		"OnTrigger" "Noctali_Boss_Push_Hp1Kill10-1"
	}
}

;fix lag
modify:
{
	match:
	{
		"classname" "logic_case"
		"hammerid" "1051563"
	}
	delete:
	{
		"OnCase01" "stage3_hell_knigh_spawnForceSpawn6-1"
		"OnCase01" "stage3_hell_knigh_spawn2ForceSpawn8-1"
		"OnCase02" "stage3_hell_knigh_spawn3ForceSpawn8-1"
		"OnCase02" "stage3_hell_knigh_spawn4ForceSpawn6-1"
		"OnCase02" "stage3_npc_boss_spawn2ForceSpawn4-1"
		"OnCase01" "stage3_npc_boss_spawnForceSpawn2-1"
	}
}

;???
modify:
{
	match:
	{
		"classname" "logic_relay"
		"hammerid" "2646670"
	}
	delete:
	{
		"OnTrigger" "pushgun_modelSkin060-1"
		"OnTrigger" "pushgun_modelSkin12.2-1"
	}
	insert:
	{
		"OnTrigger" "pushgun_model,Skin,1,60,-1"
		"OnTrigger" "pushgun_model,Skin,0,2.2,-1"
	}
}
modify:
{
	match:
	{
		"classname" "Levels_Case"
		"hammerid" "135133"
	}
	insert:
	{
		"OnCase03" "firebug1gh2,Start,,10.5,-1"
	}
}

;hp nerfs
modify:
{
	match:
	{
		"targetname" "Noctali_Boss_Hp_To_Boss"
	}
	delete:
	{
		"OnStartTouch" "pirate_counterAdd272.5-1"
		"OnStartTouch" "pirate_hp_backupAdd272.5-1"
	}
	insert:
	{
		"OnStartTouch" "pirate_counter,Add,23,2.5,-1"
		"OnStartTouch" "pirate_hp_backup,Add,23,2.5,-1"
	}
}
modify:
{
	match:
	{
		"targetname" "Noctali_Boss_Hp_To_Boss1"
	}
	delete:
	{
		"OnStartTouch" "pirate_counterAdd320.5-1"
		"OnStartTouch" "pirate_hp_backupAdd320.5-1"
	}
	insert:
	{
		"OnStartTouch" "pirate_counter,Add,25,0.5,-1"
		"OnStartTouch" "pirate_hp_backup,Add,25,0.5,-1"
	}
}
modify:
{
	match:
	{
		"targetname" "stage3_add_hp_demon"
	}
	delete:
	{
		"OnStartTouch" "pirate_counterAdd505.5-1"
	}
	insert:
	{
		"OnStartTouch" "pirate_counter,Add,26,5.5,-1"
	}
}
; Edits by issic (idk what im doing man)
; Adjust heal prop so it changes color at correct time. Also fixes not being able to use heal immediately off cooldown since the logic_relay outputs didn't finish.
modify:
{
    match:
    {
        "classname" "logic_relay"
        "targetname" "nagoibla"
    }
    delete:
    {
        "OnTrigger" "kislorod1Color255 255 25542-1"
    }
    insert:
    {
        "OnTrigger" "kislorod1Color255 255 25540-1"
    }
}
; Stop the grenade entity maker from killing itself
modify:
{
    match:
    {
        "classname" "env_entity_maker"
        "targetname" "grenadespawn1"
    }
    delete:
    {
        "OnEntitySpawned" "!selfKill1-1"
    }
}
; Fix bfg relay timing exceeding item cooldown
modify:
{
    match:
    {
        "classname" "logic_relay"
        "targetname" "bfg_relay"
    }
    delete:
    {
        "OnTrigger" "item_bfg_launcher_modelColor255 255 255 19-1"
    }
    insert:
    {
        "OnTrigger" "item_bfg_launcher_modelColor255 255 255 15-1"
    }
}
; Remake bfg button as npcclip instead of nodraw (seems like flag 16384 didnt work well)
filter:
{
    "classname" "func_button"
    "targetname" "test_button1"
}
add:
{
    "model" "*27"
    "classname" "func_button"
    "targetname" "test_button1"
    "spawnflags" "1025"
    "origin" "-7376.08 14212.5 -4028.76"
    "vscripts" "testmike/button.nut"
    "wait" "0"
    "min_use_angle" "0.8"
    "parentname" "test_center_move1"
    "onpressed" "!selfRunScriptCodefilter();0-1"
    "onuser4" "bfg_relayTrigger0.05-1"
}
; Remake rocket button as npcclip (same reasoning as above)
filter:
{
    "classname" "func_button"
    "targetname" "test_button"
}
add:
{
    "model" "*27"
    "classname" "func_button"
    "targetname" "test_button"
    "spawnflags" "1025"
    "origin" "-7203.01 13380.5 -4145.76"
    "vscripts" "testmike/button.nut"
    "wait" "0"
    "min_use_angle" "0.8"
    "parentname" "test_center_move"
    "onpressed" "!selfRunScriptCodefilter();0-1"
    "onuser4" "rocket_relayTrigger0.05-1"
}
; Fix rocket relay timing exceeding item cooldown. Also lock the button on use.
modify:
{
    match:
    {
        "classname" "logic_relay"
        "targetname" "rocket_relay"
    }
    delete:
    {
        "ontrigger" "item_rocket_launcher_modelSetAnimationrocketidle6.4-1"
    }
    insert:
    {
        "ontrigger" "item_rocket_launcher_modelSetAnimationrocketidle6-1"
        "ontrigger" "test_buttonLock0-1"
    }
}
; Add AFK tp to start of stage 2
add:
{
	"targetname" "issic_tp_stg2_start"
	"classname" "trigger_multiple"
	"startdisabled" "1"
	"wait" "0"
	"spawnflags" "1"
	"UseLandmarkAngles" "1"
	"origin" "-7392 12440 -4044.5"
	"OnStartTouch" "!activatorAddOutputorigin -6956 14144 -41240-1"
}
modify:
{
	match:
	{
		"classname" "trigger_once"
		"hammerid" "3194"
	}
	insert:
	{
		"OnStartTouch" "issic_tp_stg2_startEnable101"
	}
}
; Add tp avoidance stage 2 start area (1)
add:
{
	"classname" "trigger_teleport"
	"targetname" "issic_stg2_tp_avoid"
    "spawnflags" "1"
    "origin" "-7120 14200 -3822.5"
	"startdisabled" "1"
	"target" "teler1"
	"UseLandmarkAngles" "1"
}
modify:
{
	match:
	{
		"classname" "func_button"
		"hammerid" "2786"
	}
	insert:
	{
		"onpressed" "issic_stg2_tp_avoidEnable321"
	}
}
; Add tp avoidance stage 2 (2)
add:
{
	"model" "*364"
	"classname" "trigger_teleport"
	"targetname" "issic_stg2_tp_avoid_2"
    "spawnflags" "1"
    "origin" "-4407.07 10399.8 -5251"
	"startdisabled" "1"
	"target" "teler1"
	"UseLandmarkAngles" "1"
}
modify:
{
	match:
	{
		"classname" "trigger_once"
		"hammerid" "3634"
	}
	insert:
	{
		"OnStartTouch" "issic_stg2_tp_avoid_2Enable101"
	}
}
; Add tp avoidance stage 2 (3)
add:
{
	"model" "*358"
	"classname" "trigger_teleport"
	"targetname" "issic_stg2_tp_avoid_3"
    "spawnflags" "1"
    "origin" "-5592.55 587.43 -11645.5"
	"startdisabled" "1"
	"target" "golos1"
	"UseLandmarkAngles" "1"
}
modify:
{
	match:
	{
		"targetname" "stage2_button1"
		"hammerid" "3734"
	}
	insert:
	{
		"onpressed" "issic_stg2_tp_avoid_3Enable91"
	}
}
; Add tp avoidance stage 2 (4)
add:
{
	"model" "*211"
	"classname" "trigger_teleport"
	"targetname" "issic_stg2_tp_avoid_4"
    "spawnflags" "1"
    "origin" "-1297.56 588.83 -11768.9"
	"startdisabled" "1"
	"target" "golos1"
	"UseLandmarkAngles" "1"
}
modify:
{
	match:
	{
		"targetname" "stage2_button1"
		"hammerid" "3734"
	}
	insert:
	{
		"onpressed" "issic_stg2_tp_avoid_4Enable91"
	}
}
; Prevent zms from picking up multiple items
modify:
{
	match:
	{
		"classname" "trigger_once"
		"targetname" "skin_pauk_strip"
	}
	insert:
	{
		"OnStartTouch" "!activatorAddContextzm_user:10-1"
	}
}
modify:
{
	match:
	{
		"classname" "trigger_once"
		"targetname" "pinky_skin_stripweapon"
	}
	insert:
	{
		"OnStartTouch" "!activatorAddContextzm_user:10-1"
	}
}
modify:
{
	match:
	{
		"classname" "trigger_once"
		"targetname" "skin_spider_strip"
	}
	insert:
	{
		"OnStartTouch" "!activatorAddContextzm_user:10-1"
	}
}
modify:
{
	match:
	{
		"classname" "trigger_once"
		"targetname" "skin_revenant_strip"
	}
	insert:
	{
		"OnStartTouch" "!activatorAddContextzm_user:10-1"
	}
}
modify:
{
	match:
	{
		"classname" "logic_auto"
		"hammerid" "135137"
	}
	insert:
	{
		
		"OnMapSpawn" "playerClearContext0-1"
	}
}
add:
{
	"origin" "-5792 12144 -4128"
	"classname" "filter_activator_context"
	"targetname" "filter_zm_user"
	"ResponseContext" "zm_user"
	"Negated" "Allow entities that match criteria"
}
add:
{
	"model" "*36"
	"classname" "trigger_multiple"
	"origin" "-6417.82 12201.3 -4066.5"
	"filtername" "filter_zm_user"
	"StartDisabled" "0"
	"wait" "0"
	"spawnflags" "1"
	"OnStartTouch" "!activatorAddOutputorigin -6441 11506 -41200-1"
}
; Add tp avoid for stage 3 (start area) (3 spots)
add:
{
	"classname" "trigger_teleport"
	"targetname" "issic_stg3_tp_avoid"
    "spawnflags" "1"
    "origin" "-7110 14200 -3822.5"
	"startdisabled" "1"
	"target" "hellteleport"
	"UseLandmarkAngles" "1"
}
add:
{
	"model" "*38"
	"classname" "trigger_teleport"
	"targetname" "issic_stg3_tp_avoid_2"
    "spawnflags" "1"
    "origin" "-8494.82 11267.6 -4021.5"
	"startdisabled" "1"
	"target" "hellteleport"
	"UseLandmarkAngles" "1"
}
add:
{
	"model" "*203"
	"targetname" "issic_stg3_tp_avoid_3"
	"classname" "trigger_teleport"
	"origin" "-3303 13052.1 -3903.08"
	"spawnflags" "1"
	"startdisabled" "1"
	"target" "hellteleport"
	"UseLandmarkAngles" "1"
}
modify:
{
	match:
	{
		"classname" "trigger_teleport"
		"hammerid" "2673"
	}
	insert:
	{
		"OnStartTouch" "issic_stg3_tp_avoidEnable101"
		"OnStartTouch" "issic_stg3_tp_avoid_2Enable101"
		"OnStartTouch" "issic_stg3_tp_avoid_3Enable101"
	}
}
; Add tp to stage 2 that exists on css 
add:
{
	"targetname" "issic_tp_stg2_gap"
	"classname" "trigger_teleport"
	"origin" "-5502 14562 -4044.5"
	"spawnflags" "1"
	"startdisabled" "1"
	"target" "teler1"
	"UseLandmarkAngles" "1"
}
modify:
{
	match:
	{
		"classname" "func_button"
		"hammerid" "2786"
	}
	insert:
	{
		"onpressed" "issic_tp_stg2_gapEnable321"
	}
}
; Nerf zm spider fireball (This nerf most likely needs tweaking)
modify:
{
	match:
	{
		"classname" "trigger_hurt"
		"targetname" "hurtimp1"
	}
	replace:
	{
		"damage" "35"
	}
}
; Nerf zm skeleton firebomb (This nerf most likely needs tweaking)
modify:
{
	match:
	{
		"classname" "env_explosion"
		"targetname" "gila3"
	}
	replace:
	{
		"iMagnitude" "30"
		"iRadiusOverride" "350"
	}
}
; Fix bfg math counter to reflect model (7 uses instead of 8)
modify:
{
	match:
	{
		"classname" "math_counter"
		"targetname" "bfg_model_counter"
	}
	delete:
	{
		"OnHitMax" "item_bfg_launcher_modelKill0-1"
	}
	replace:
	{
		"max" "7"
	}
	insert:
	{
		"OnHitMax" "item_bfg_launcher_modelKill2.3-1"
	}
}
; Move heart item freeze more to center 
modify:
{
	match:
	{
		"targetname" "heart_template_freeze"
		"classname" "point_template"
	}
	replace:
	{
		"origin" "-6699 14253 -3883"
	}
}
; Move electro nade more to center
modify:
{
	match:
	{
		"targetname" "grenade_spawn"
		"classname" "point_template"
	}
	replace:
	{
		"origin" "-6314 14087 -4141"
	}
}
; Add blocking damage to stg 2 elevator
modify:
{
	match:
	{
		"targetname" "stage2_door1"
		"classname" "func_door"
	}
	replace:
	{
		"dmg" "99999"
	}
}
modify:
{
	match:
	{
		"targetname" "stage2_doo2"
		"classname" "func_door"
	}
	replace:
	{
		"dmg" "99999"
	}
}
; Move where boss hp is added for stage 3 boss fight (prevents cheesing the boss where 1 ct goes in)
modify:
{
	match:
	{
		"classname" "trigger_multiple"
		"targetname" "Noctali_Boss_Hp_To_Boss1"
	}
	delete:
	{
		"OnStartTouch" "hp_counters_templalteForceSpawn01"
		"OnStartTouch" "pirate_counterAdd320.5-1"
		"OnStartTouch" "pirate_hp_backupAdd320.5-1"
	}
}
add:
{
	"model" "*334"
	"classname" "trigger_multiple"
	"spawnflags" "1"
	"origin" "-11525 -8945.5 -262"
	"startdisabled" "0"
	"wait" "60"
	"filtername" "Filter_Team_Humans"
	"OnStartTouch" "hp_counters_templalteForceSpawn01"
	"OnStartTouch" "pirate_counterAdd320.5-1"
	"OnStartTouch" "pirate_hp_backupAdd320.5-1"
}
; ======= LOGIC AUTO FOR CUSTOM SIZED TRIGGERS =======
modify:
{
	match:
	{
		"classname" "logic_auto"
		"hammerid" "135137"
	}
	insert:
	{
		"OnMapSpawn" "issic_tp_stg2_startAddOutputsolid 20.51"
		"OnMapSpawn" "issic_tp_stg2_startAddOutputmins -1232 -1400 -111.511"
		"OnMapSpawn" "issic_tp_stg2_startAddOutputmaxs 1232 1400 111.511"

		"OnMapSpawn" "issic_stg2_tp_avoidAddOutputsolid 20.51"
		"OnMapSpawn" "issic_stg2_tp_avoidAddOutputmins -468 -352 -110.511"
		"OnMapSpawn" "issic_stg2_tp_avoidAddOutputmaxs 468 352 110.511"

		"OnMapSpawn" "issic_stg3_tp_avoidAddOutputsolid 20.51"
		"OnMapSpawn" "issic_stg3_tp_avoidAddOutputmins -478 -352 -110.511"
		"OnMapSpawn" "issic_stg3_tp_avoidAddOutputmaxs 478 352 110.511"

		"OnMapSpawn" "issic_tp_stg2_gapAddOutputsolid 20.51"
		"OnMapSpawn" "issic_tp_stg2_gapAddOutputmins -2078 -718 -111.511"
		"OnMapSpawn" "issic_tp_stg2_gapAddOutputmaxs 2078 718 111.511"
	}
}
; ======= LOGIC AUTO FOR CUSTOM SIZED TRIGGERS =======